<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/login/register.css">
    <link rel="icon" href="/img/consultorio.png" type="image/png">
    <title>Registro de Paciente</title>
</head>
<body>
    <div class="register-form">
        <h1>Formulario de Registro de Paciente</h1>
        <form action="/register/patient" method="POST" onsubmit="return validateForm()">
            <label for="dni">DNI</label>
            <input type="text" name="dni" id="dni" required tabindex="1" pattern="\d{6,8}" title="El DNI debe tener entre 6 y 8 dígitos.">
        
            <label for="nombre">Nombre</label>
            <input type="text" name="nombre" id="nombre" required tabindex="2" pattern="^[a-zA-ZÀ-ÿ\s]{1,40}$" title="El nombre solo puede contener letras y espacios.">
        
            <label for="apellido">Apellido</label>
            <input type="text" name="apellido" id="apellido" required tabindex="3" pattern="^[a-zA-ZÀ-ÿ\s]{1,40}$" title="El apellido solo puede contener letras y espacios.">
        
            <label for="obra_social">Obra Social</label>
            <input type="text" name="obra_social" id="obra_social" required tabindex="4" pattern="^[a-zA-ZÀ-ÿ\s]{1,40}$" title="La obra social solo puede contener letras y espacios.">
        
            <label for="telefono">Teléfono</label>
            <input type="text" name="telefono" id="telefono" required tabindex="5" pattern="^\d+$" title="El teléfono solo puede contener números.">
        
            <label for="email">Email</label>
            <input type="email" name="email" id="email" required tabindex="6">
        
            <label for="pass">Contraseña</label>
            <input type="password" name="pass" id="pass" required tabindex="7">
        
            <div style="display: inline;">
                <a href="/" class="btn-cancel">Cancelar</a>
                <input type="submit" class="btn-save" value="Guardar">
            </div>
        </form>   
    </div>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>

    <% if (typeof alert !== "undefined" && alert) { %>
    <script>
        Swal.fire({
            title: '<%= alertTitle %>',
            text: '<%= alertMessage %>',
            icon: '<%= alertIcon %>',
            showConfirmButton: <%= showConfirmButton ? "true" : "false" %>,
            timer: <%= typeof timer !== "undefined" ? timer : "null" %>
        }).then(() => {
            window.location = '/login/this<%= ruta %>';
        });

        function validateForm() {
        const dni = document.getElementById("dni").value;
        const nombre = document.getElementById("nombre").value;
        const apellido = document.getElementById("apellido").value;
        const obraSocial = document.getElementById("obra_social").value;
        const telefono = document.getElementById("telefono").value;

        if (!/^\d{6,8}$/.test(dni)) {
            alert("El DNI debe tener entre 6 y 8 dígitos.");
            return false;
        }

        const nameRegex = /^[a-zA-ZÀ-ÿ\s]{1,40}$/;
        if (!nameRegex.test(nombre)) {
            alert("El nombre solo puede contener letras y espacios.");
            return false;
        }
        if (!nameRegex.test(apellido)) {
            alert("El apellido solo puede contener letras y espacios.");
            return false;
        }
        if (!nameRegex.test(obraSocial)) {
            alert("La obra social solo puede contener letras y espacios.");
            return false;
        }

        if (!/^\d+$/.test(telefono)) {
            alert("El teléfono solo puede contener números.");
            return false;
        }

        return true;
    }
    </script>
    <% } %>
</body>
</html>
